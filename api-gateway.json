{"openapi":"3.0.0","info":{"title":"API Gateway docs","description":"API Gateway for microservices of Blogger microservices. \n\nIn order to try out the endpoints in Swagger UI, you can use Api gateway server or choose corresponding server from the dropdown\n\nThe gateway is calling to api registry upon the start to retrieve the data of all the registered apis which it uses for creating the proxy -> it compares the apiname which is the path obtained from the docs of each registered api  and if it finds match it makes the call to the corresponding server using the same path.\n\nThe data is being cached for 24 hours using redis cache. In case of change, the application is listening on rabbitmq exchange queue specific for communication of api registry and gateway and if it recieves the message about update, it reloads the data directly","contact":{"name":"Marek Slavicek"},"version":"1.0.0"},"servers":[{"url":"http://localhost:3333","description":"API Gateway server"},{"url":"http://localhost:3000/","description":"User Management Service"},{"url":"http://localhost:5555/","description":"Blog Management Service"},{"url":"http://localhost:7777/","description":"Comments Management Service"},{"url":"http://localhost:8080/","description":"Votes Management Service"}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","name":"authorization","in":"headers"}},"schemas":{"CreateUserInput":{"type":"object","required":["username","password","passwordConfirmation","email"],"properties":{"email":{"type":"string","default":"john.doe@example.com"},"username":{"type":"string","default":"JohnDoe99"},"password":{"type":"string","default":"Password123!"},"passwordConfirmation":{"type":"string","default":"Password123!"}}},"CreateUserResponse":{"type":"object","properties":{"id":{"type":"number"},"username":{"type":"string"}}},"LoginUserInput":{"type":"object","required":["username","password"],"properties":{"username":{"type":"string","default":"JohnDoe99"},"password":{"type":"string","default":"Password123!"}}},"LoginUserResponse":{"type":"object","properties":{"token":{"type":"string"},"id":{"type":"number"},"username":{"type":"string"},"avatar":{"type":"string"}}},"ForgottenPasswordUserSchema":{"type":"object","required":["email"],"properties":{"email":{"type":"string","default":"john.doe@example.com"}}},"ApiMessage":{"type":"object","properties":{"message":{"type":"string"}}},"ResetPasswordUserSchema":{"type":"object","required":["email","password","passwordConfirmation"],"properties":{"email":{"type":"string","default":"john.doe@example.com"},"password":{"type":"string","default":"Password123!"},"passwordConfirmation":{"type":"string","default":"Password123!"}}},"ActivateUserAccountSchema":{"type":"object","required":["avatar"],"properties":{"avatar":{"type":"string","default":"assets/avatar.jpg"}}},"ActivationResponse":{"type":"object","properties":{"username":{"type":"string"},"active":{"type":"boolean"},"avatar":{"type":"string"},"token":{"type":"string"}}},"ApiError":{"type":"object","properties":{"error":{"type":"string"}}},"ValidationError":{"type":"object","properties":{"code":{"type":"string"},"expected":{"type":"string"},"received":{"type":"string"},"path":{"type":"array","items":{"type":"string"}},"message":{"type":"string"}}},"CreateUpdateArticleInput":{"type":"object","required":["title","perex","content","image","state"],"properties":{"title":{"type":"string","default":"My title"},"perex":{"type":"string","default":"Perex must be at least 50 characters or the request won't go through"},"content":{"type":"string","default":"Main thing"},"image":{"type":"string","default":"path to image on frontend app"},"state":{"type":"string","default":"draft"}}},"CreateArticleResponse":{"type":"object","properties":{"id":{"type":"number"},"title":{"type":"string"},"state":{"type":"string"},"image":{"type":"string"},"createdAt":{"type":"date"}}},"GetUserArticlesResponse":{"type":"object","properties":{"id":{"type":"number"},"title":{"type":"string"},"perex":{"type":"string"},"content":{"type":"string"},"state":{"type":"string"},"image":{"type":"string"},"createdAt":{"type":"date"},"updatedAt":{"type":"date"},"username":{"type":"string"}}},"UpdateArticleResponse":{"type":"object","properties":{"id":{"type":"number"},"title":{"type":"string"},"perex":{"type":"string"},"content":{"type":"string"},"state":{"type":"string"},"image":{"type":"string"},"createdAt":{"type":"date"},"updatedAt":{"type":"date"}}},"CreateCommentInput":{"type":"object","required":["author","content"],"properties":{"author":{"type":"string","default":"John Doe"},"content":{"type":"string","default":"Loving this content"},"parent_id":{"type":"number","default":1}}},"CreateCommentResponse":{"type":"object","properties":{"id":{"type":"number"},"depth":{"type":"number"},"created_at":{"type":"number"},"author":{"type":"string"},"content":{"type":"string"},"parent_id":{"type":"number"},"article_id":{"type":"number"}}},"GetCommentsResponse":{"type":"object","properties":{"id":{"type":"number"},"author":{"type":"string"},"content":{"type":"string"},"article_id":{"type":"number"},"parent_id":{"type":"number"},"depth":{"type":"number"},"created_at":{"type":"number"},"children":{"type":"array","items":{"$ref":"#/components/schemas/GetCommentsResponse"}}}},"CreateVoteInput":{"type":"object","required":["upvote","downvote"],"properties":{"upvote":{"type":"boolean","default":true,"nullable":true},"downvote":{"type":"boolean","default":null,"nullable":true}}},"VotesCount":{"type":"object","properties":{"upvotes":{"type":"number"},"downvotes":{"type":"number"}}}}},"paths":{"/user-service-api/users":{"post":{"tags":["UserServiceAPI"],"summary":"Register a user","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserInput"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserResponse"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"409":{"description":"Conflict","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/user-service-api/users/login":{"post":{"tags":["UserServiceAPI"],"summary":"Logs in a user","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginUserInput"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginUserResponse"}}}},"400":{"description":"Bad request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"401":{"description":"Unauthorized - some of the fields doesn't match","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}},"403":{"description":"Forbidden - user is not active","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/user-service-api/users/forgotten-password":{"post":{"tags":["UserServiceAPI"],"summary":"Sends email with token to reset password","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgottenPasswordUserSchema"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"404":{"description":"Not found - user email","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/user-service-api/users/recover":{"post":{"tags":["UserServiceAPI"],"summary":"Changes user's password","parameters":[{"in":"query","name":"token","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordUserSchema"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}},{"$ref":"#/components/schemas/ApiError"}]}}}},"403":{"description":"Forbidden - token expired or token not assigned to user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}},"404":{"description":"Not found - user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/user-service-api/users/activate":{"post":{"tags":["UserServiceAPI"],"summary":"Activates user account based on query token","parameters":[{"in":"query","name":"token","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActivateUserAccountSchema"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActivationResponse"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"403":{"description":"Forbidden - token expired, token not assigned to user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/user-service-api/users/identify":{"get":{"tags":["UserServiceAPI"],"summary":"Used for FE application when user is accessing the reset password page, the request is sent in order to allow user to access the page","parameters":[{"in":"query","name":"token","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"403":{"description":"Unauthorized - token not assigned to user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/blogger-service-api/bloggers/{userId}/articles":{"post":{"tags":["BloggerServiceAPI"],"summary":"Create Article","parameters":[{"in":"path","name":"userId","required":true,"schema":{"type":"string"}}],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUpdateArticleInput"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateArticleResponse"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}},"403":{"description":"Forbidden - userId in path doesn't match userId from JWT","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"get":{"tags":["BloggerServiceAPI"],"summary":"Get articles for user as admin","parameters":[{"in":"path","name":"userId","required":true,"schema":{"type":"string"}}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GetUserArticlesResponse"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}},"404":{"description":"Not found - user id doesn't match the article","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/blogger-service-api/bloggers/{userId}/articles/{articleId}":{"put":{"tags":["BloggerServiceAPI"],"summary":"Update article","parameters":[{"in":"path","name":"userId","required":true,"schema":{"type":"string"}},{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}}],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUpdateArticleInput"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GetUserArticlesResponse"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}},"404":{"description":"Not found - Article not found based on id and user id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"delete":{"tags":["BloggerServiceAPI"],"summary":"Delete article","parameters":[{"in":"path","name":"userId","required":true,"schema":{"type":"string"}},{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}},"404":{"description":"Not found - Article not found based on id and user id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/blogger-service-api/blogs/{username}/articles":{"get":{"tags":["BloggerServiceAPI"],"summary":"Get all articles by username -> public","parameters":[{"in":"path","name":"username","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GetUserArticlesResponse"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"404":{"description":"Not found - Article not found based on id and user id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/blogger-service-api/featured-blogs":{"get":{"tags":["BloggerServiceAPI"],"summary":"Get featured articles","responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GetUserArticlesResponse"}}}}},"500":{"description":"Something went wrong","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/comments-service-api/articles/{articleId}/comments":{"post":{"tags":["CommentsServiceAPI"],"summary":"Create Comment for article","parameters":[{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCommentInput"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCommentResponse"}}}},"202":{"description":"Accepted - article id not validated through blogger service","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"404":{"description":"Not found - article not found by id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"get":{"tags":["CommentsServiceAPI"],"summary":"Get comments for article","parameters":[{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GetCommentsResponse"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}}}}},"/votes-service-api/articles/{articleId}/comments/{commentId}/votes":{"post":{"tags":["VotesServiceAPI"],"summary":"Create Vote for comment","parameters":[{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}},{"in":"path","name":"commentId","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateVoteInput"}}}},"responses":{"200":{"description":"Success - Vote annulled - both values send null","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"201":{"description":"Created - Vote created/updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"202":{"description":"Accepted - comment id not validated through comments service","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiMessage"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"404":{"description":"Not found - Comment not found by id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"get":{"tags":["VotesServiceAPI"],"summary":"Get Vote count for comment","parameters":[{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}},{"in":"path","name":"commentId","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/VotesCount"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"500":{"description":"Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/votes-service-api/articles/{articleId}/comments-votes":{"get":{"tags":["VotesServiceAPI"],"summary":"Get All Vote count for article id","parameters":[{"in":"path","name":"articleId","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/VotesCount"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}}},"500":{"description":"Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}}},"tags":[]}